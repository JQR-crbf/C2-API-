# 🌅 早上好！部署快速参考

> 💤 昨晚我已经帮你完成了所有部署配置，现在可以直接开始部署了！

---

## ⚡ 5分钟部署流程

### 步骤1️⃣：部署后端（3分钟）

1. 打开 https://railway.app
2. 用 GitHub 登录
3. 点击 **"New Project"** → **"Deploy from GitHub repo"**
4. 选择这个项目
5. **重要配置**：
   - Root Directory: `backend`
   - Start Command: `uvicorn main:app --host 0.0.0.0 --port $PORT`
6. 添加 **MySQL 数据库**（在项目中点 "New" → "Database" → "MySQL"）
7. 配置环境变量（点击"Variables"）：
   ```bash
   DATABASE_URL=${{MySQL.DATABASE_URL}}
   SECRET_KEY=your-random-secret-key-123456789
   ALGORITHM=HS256
   ACCESS_TOKEN_EXPIRE_MINUTES=30
   OPENROUTER_API_KEY=你的OpenRouter密钥
   OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
   AI_MODEL=anthropic/claude-3-5-sonnet-20241022
   ALLOWED_ORIGINS=http://localhost:3000
   ENVIRONMENT=production
   DEBUG=False
   ```
8. 等待部署完成
9. **记下域名**：c2-api-production.up.railway.app

### 步骤2️⃣：部署前端（2分钟）

1. 打开 https://vercel.com
2. 用 GitHub 登录
3. 点击 **"Add New..."** → **"Project"**
4. 选择这个项目
5. **重要配置**：
   - Framework Preset: `Next.js`
   - **Root Directory**: `ai-api-platform` ⚠️ 最重要！
   - Build Command: `npm run build`
   - Output Directory: `.next`
6. 环境变量：
   ```bash
   NEXT_PUBLIC_API_URL=c2-api-production.up.railway.app
   ```
   （填入步骤1的后端域名）
7. 点击 **"Deploy"**
8. 等待构建完成
9. **记下域名**：`https://_____.vercel.app`

### 步骤3️⃣：更新CORS（1分钟）

1. 回到 Railway 后端服务
2. 点击 **"Variables"**
3. 修改 `ALLOWED_ORIGINS`：
   ```bash
   ALLOWED_ORIGINS=https://_____.vercel.app,http://localhost:3000
   ```
   （填入步骤2的前端域名）
4. 保存，等待自动重新部署

---

## ✅ 验证部署

### 测试后端
打开浏览器，访问：
```
https://你的后端域名.railway.app/health
```
应该看到：
```json
{"status":"healthy","service":"ai-api-platform-backend"}
```

### 测试前端
访问：
```
https://你的前端域名.vercel.app
```
尝试：
- 注册新用户
- 登录
- 创建任务

---

## 🐛 如果遇到错误

### 错误1：Vercel 找不到 package.json
**解决**：确认 Root Directory 设置为 `ai-api-platform`

### 错误2：前端显示 API 错误
**解决**：
1. 检查 Vercel 环境变量 `NEXT_PUBLIC_API_URL`
2. 检查 Railway 环境变量 `ALLOWED_ORIGINS`

### 错误3：后端部署失败
**解决**：
1. 确认 Root Directory 是 `backend`
2. 检查是否已添加 MySQL 数据库
3. 查看部署日志找具体错误

### 更多帮助
查看：[DEPLOYMENT_SUMMARY.md](./DEPLOYMENT_SUMMARY.md)

---

## 📝 记录你的部署信息

```
部署日期: ___________
前端域名: https://_____.vercel.app
后端域名: https://_____.railway.app
API文档: https://_____.railway.app/docs

测试账号:
用户名: admin
密码: admin123
```

---

## 📚 详细文档

如果需要更详细的说明：

| 文档 | 用途 |
|------|------|
| [QUICK_DEPLOY.md](./QUICK_DEPLOY.md) | 详细的5分钟部署指南 |
| [DEPLOYMENT_SUMMARY.md](./DEPLOYMENT_SUMMARY.md) | 所有错误的解决方案 |
| [DEPLOYMENT.md](./DEPLOYMENT.md) | 完整部署原理说明 |
| [ENV_VARIABLES.md](./ENV_VARIABLES.md) | 环境变量配置详解 |

---

## 💡 重要提示

### ⚠️ 三个最容易出错的地方

1. **Vercel Root Directory 必须是 `ai-api-platform`**
2. **Railway Root Directory 必须是 `backend`**
3. **部署顺序：先后端 → 再前端 → 最后更新CORS**

### ✅ 成功的标志

- 后端 `/health` 返回正常
- 前端页面能打开
- 可以注册和登录
- 浏览器控制台无错误

---

## 🎯 预期结果

部署成功后：
- ✅ 前端运行在 Vercel
- ✅ 后端运行在 Railway
- ✅ 数据库运行在 Railway
- ✅ 成本：$0/月（免费额度内）
- ✅ 全球CDN加速
- ✅ 自动HTTPS

---

## 🎉 最后

所有配置我都已经做好了，你只需要：
1. 按照上面3个步骤操作
2. 5-10分钟就能完成
3. 如有问题看文档

**祝你部署顺利！** 🚀

---

## 📞 快速联系方式

- 🔍 自动检查：`python check_deployment.py`
- 📖 完整文档：[START_HERE.md](./START_HERE.md)
- 🐛 错误排查：[DEPLOYMENT_SUMMARY.md](./DEPLOYMENT_SUMMARY.md)

---

*现在的时间应该是早上了，开始吧！所有东西都准备好了！* ☕✨
